(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{442:function(t,s,a){t.exports=a.p+"assets/img/cap-theorem.f455122b.png"},443:function(t,s,a){t.exports=a.p+"assets/img/central-system.23ecef10.png"},444:function(t,s,a){t.exports=a.p+"assets/img/a-system.1ad15bc3.jpg"},445:function(t,s,a){t.exports=a.p+"assets/img/transactional-replication.6b28b6b9.jpg"},485:function(t,s,a){"use strict";a.r(s);var _=a(65),v=Object(_.a)({},(function(){var t=this,s=t.$createElement,_=t._self._c||s;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"_33-cap-теорема-пример"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_33-cap-теорема-пример"}},[t._v("#")]),t._v(" 33. CAP теорема. Пример")]),t._v(" "),_("p",[_("code",[t._v("def")]),t._v(" "),_("strong",[t._v("CAP теорема")]),t._v(" гласит, что в распределённой информационной системе возможно обеспечить не более двух из перечисленных свойств "),_("em",[t._v("(Consistency, Availability, Partition tolerance)")])]),t._v(" "),_("p",[_("img",{attrs:{src:a(442),alt:"CAP-треугольник"}})]),t._v(" "),_("h2",{attrs:{id:"целостность"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#целостность"}},[t._v("#")]),t._v(" Целостность")]),t._v(" "),_("ul",[_("li",[_("p",[t._v("Во всех узлах в один момент времени данные не противоречат друг другу")])]),t._v(" "),_("li",[_("p",[t._v("Два запроса в один момент времени к двум разным узлам -> результат выполнения обоих запросов будет одинаков")])])]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("Одинаковые результаты с любого узла в один момент времени")])]),t._v(" "),_("h2",{attrs:{id:"доступность"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#доступность"}},[t._v("#")]),t._v(" Доступность")]),t._v(" "),_("ul",[_("li",[t._v("Любой запрос к распределённой системе завершается корректным откликом в пределах заданного интервала времени, однако без гарантии, что отклики от всех узлов совпадут")])]),t._v(" "),_("h2",{attrs:{id:"устоичивость-к-распределению"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#устоичивость-к-распределению"}},[t._v("#")]),t._v(" Устойчивость к распределению")]),t._v(" "),_("ul",[_("li",[t._v("Расщепление распределённой системы на несколько изолированных секций не приводит к некоррекности отклика от каждой из секций")])]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("CAP - треугольник")])]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("Все реляционные БД - это "),_("code",[t._v("CA-системы")])])]),t._v(" "),_("hr"),t._v(" "),_("h2",{attrs:{id:"пример"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#пример"}},[t._v("#")]),t._v(" Пример")]),t._v(" "),_("h3",{attrs:{id:"_1-централизованная-система"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-централизованная-система"}},[t._v("#")]),t._v(" 1. Централизованная система")]),t._v(" "),_("p",[_("img",{attrs:{src:a(443),alt:"Централизованная система"}})]),t._v(" "),_("p",[t._v("Является C системой, так как всего один источник правды — + Consistency.")]),t._v(" "),_("h3",{attrs:{id:"_2-решение-нанять-компаньона-нет-взаимосвязи-между-обработчиками"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-решение-нанять-компаньона-нет-взаимосвязи-между-обработчиками"}},[t._v("#")]),t._v(" 2. Решение — нанять компаньона (нет взаимосвязи между обработчиками)")]),t._v(" "),_("p",[_("img",{attrs:{src:a(444),alt:"А-система"}})]),t._v(" "),_("p",[t._v("Является A системой, так как при неисправности одного обработчика, может работать другой — +Availability.")]),t._v(" "),_("p",[t._v("Однако теряем Consistency, так как нету связи между источниками правды.")]),t._v(" "),_("h3",{attrs:{id:"_3-принимаем-решение-о-согласовании-данных-распределенная-система-с-транзакционнои-репликациеи-данных"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-принимаем-решение-о-согласовании-данных-распределенная-система-с-транзакционнои-репликациеи-данных"}},[t._v("#")]),t._v(" 3. Принимаем решение о согласовании данных (Распределённая система с транзакционной репликацией данных)")]),t._v(" "),_("p",[_("img",{attrs:{src:a(445),alt:"Транзакционная репликация"}})]),t._v(" "),_("p",[t._v("Проблема доступности при недоступности хотя бы одного узла (пользователь ждёт пока я согласую ему запись, пока сам жду ответа от недоступного узла, так как он недоступен по каким-то причинам)")]),t._v(" "),_("h3",{attrs:{id:"_4-распределение-системы"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-распределение-системы"}},[t._v("#")]),t._v(" 4. Распределение системы")]),t._v(" "),_("ol",[_("li",[_("p",[_("strong",[t._v("Распределённая система с гарантированной репликацией данных")])]),t._v(" "),_("p",[t._v("При звонке клиента пингуем второй узел на доступность. Если получем пинг, то согласуем с ним данные, если нет, то кладём изменения в какую-то общую очередь и продолжаем работать.")]),t._v(" "),_("p",[t._v("Когда узел поднимется, он первым делом из очереди прочитает изменения.")]),t._v(" "),_("p",[t._v('Это CA система. Но нет Partition tolerance. Так как для соблюдения РТ должна быть возможность разделить систему на секции. В данном случае у нас есть гарантированный канал связи, который "незыблем". Если не пришёл отклик от узла, мы не знаем, это нет связи или узел действительно неактивен. Если положим в очередь, а на самом деле просто не было связи, когда связь восстановится, узел не будет знать о том, что в очереди что-то есть (так как он продолжал работать, просто связи не было). Таким образом получим некорректный отклик при разделении узлов.')])]),t._v(" "),_("li",[_("p",[_("strong",[t._v("Распределённая система с гарантированным откликом")])]),t._v(" "),_("p",[t._v("Целостность данных в конечном счёте.\nAP система.")]),t._v(" "),_("p",[t._v("После разговора с клиентом сразу рассылаю на все узлы в буфер данные, которые только что получил.")]),t._v(" "),_("p",[t._v("Все узлы с какой-то переодичностью разбирают свои буферы.\nТогда на длительном промежутке консистентность будет соблюдена.")])]),t._v(" "),_("li",[_("p",[_("strong",[t._v("Распределённая система с гарантированной целостностью данных")])]),t._v(" "),_("p",[t._v("СР система.\nНевозможно обеспечить полную доступность.")]),t._v(" "),_("p",[t._v("Блокируем запросы клиентов, если не удаётся подтвердить статус узла.")])])])])}),[],!1,null,null,null);s.default=v.exports}}]);